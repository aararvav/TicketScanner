<!DOCTYPE html>
<html>
<head>
  <title>Analytics - Ticket Scanner</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" />
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet" />
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet" />
  <link href="/static/css/main.css" rel="stylesheet" />
  <style>
    .stats-header {
      margin-bottom: 30px;
    }
    
    .stats-title {
      font-size: var(--text-3xl);
      font-weight: 700;
      background: var(--primary-gradient);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
      margin-bottom: 12px;
    }
    
    .stats-subtitle {
      color: var(--text-secondary);
      font-size: var(--text-lg);
    }
    
    .metric-card {
      background: var(--bg-card);
      border-radius: 16px;
      padding: 24px;
      margin-bottom: 20px;
      border: 1px solid var(--border-color);
      transition: all 0.3s ease;
    }
    
    .metric-card:hover {
      transform: translateY(-4px);
      border-color: #667eea;
      box-shadow: 0 8px 25px rgba(102, 126, 234, 0.2);
    }
    
    .metric-header {
      display: flex;
      align-items: center;
      margin-bottom: 16px;
    }
    
    .metric-icon {
      width: 48px;
      height: 48px;
      border-radius: 12px;
      background: var(--primary-gradient);
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 20px;
      color: white;
      margin-right: 16px;
    }
    
    .metric-title {
      font-size: var(--text-lg);
      font-weight: 600;
      color: var(--text-primary);
      margin-bottom: 4px;
    }
    
    .metric-subtitle {
      color: var(--text-secondary);
      font-size: var(--text-sm);
    }
    
    .metric-value {
      font-size: var(--text-3xl);
      font-weight: 700;
      color: var(--text-primary);
      margin-bottom: 8px;
    }
    
    .metric-change {
      display: flex;
      align-items: center;
      font-size: var(--text-sm);
    }
    
    .metric-change.positive {
      color: var(--success-color);
    }
    
    .metric-change.negative {
      color: var(--error-color);
    }
    
    .chart-container {
      background: var(--bg-card);
      border-radius: 16px;
      padding: 24px;
      margin-bottom: 20px;
      border: 1px solid var(--border-color);
    }
    
    .chart-title {
      font-size: var(--text-xl);
      font-weight: 600;
      color: var(--text-primary);
      margin-bottom: 16px;
    }
    
    .chart-placeholder {
      height: 200px;
      background: var(--bg-secondary);
      border-radius: 8px;
      display: flex;
      align-items: center;
      justify-content: center;
      color: var(--text-secondary);
      font-size: var(--text-lg);
    }
    
    .time-filter {
      display: flex;
      gap: 12px;
      margin-bottom: 24px;
      flex-wrap: wrap;
    }
    
    .filter-btn {
      padding: 8px 16px;
      border-radius: 8px;
      border: 1px solid var(--border-color);
      background: var(--bg-secondary);
      color: var(--text-secondary);
      font-size: 14px;
      cursor: pointer;
      transition: all 0.3s ease;
    }
    
    .filter-btn.active {
      background: var(--primary-gradient);
      color: white;
      border-color: #667eea;
    }
    
    .filter-btn:hover {
      border-color: #667eea;
      color: var(--text-primary);
    }
    
    .empty-state {
      text-align: center;
      padding: 60px 20px;
      color: var(--text-secondary);
    }
    
    .empty-state i {
      font-size: 48px;
      margin-bottom: 16px;
      color: var(--text-muted);
    }
  </style>
</head>
<body>
  <div class="app-container">
    <!-- Sidebar -->
    <aside class="sidebar">
      <div class="sidebar-header">
        <i class="fas fa-ticket-alt"></i>
        <span>TicketScanner</span>
      </div>
      
      <nav class="sidebar-nav">
        <a href="/dashboard" class="nav-item">
          <i class="fas fa-home"></i>
          <span>Dashboard</span>
        </a>
        <a href="/scan" class="nav-item">
          <i class="fas fa-qrcode"></i>
          <span>Scan QR</span>
        </a>
        <a href="/add" class="nav-item">
          <i class="fas fa-plus"></i>
          <span>Add Ticket</span>
        </a>
        <a href="/list" class="nav-item">
          <i class="fas fa-list"></i>
          <span>Guest List</span>
        </a>
        <a href="/events" class="nav-item">
          <i class="fas fa-calendar"></i>
          <span>Events</span>
        </a>
        <a href="/stats" class="nav-item active">
          <i class="fas fa-chart-bar"></i>
          <span>Analytics</span>
        </a>
        <a href="/settings" class="nav-item">
          <i class="fas fa-cog"></i>
          <span>Settings</span>
        </a>
        <a href="/logout" class="nav-item">
          <i class="fas fa-sign-out-alt"></i>
          <span>Logout</span>
        </a>
      </nav>
    </aside>
    
    <!-- Main Content -->
    <main class="main-content">
      <!-- Flash Messages -->
      {% with messages = get_flashed_messages(with_categories=true) %}
        {% if messages %}
          {% for category, message in messages %}
            <div class="alert alert-{{ 'error' if category == 'error' else category }} animate-fade-in">
              <i class="fas fa-{{ 'exclamation-circle' if category == 'error' else 'check-circle' }}"></i>
              {{ message }}
            </div>
          {% endfor %}
        {% endif %}
      {% endwith %}

      <div class="stats-header">
        <h1 class="stats-title">
          <i class="fas fa-chart-bar"></i> Analytics
        </h1>
        <p class="stats-subtitle">Track your event performance and insights</p>
      </div>

      <!-- Time Filter -->
      <div class="time-filter">
        <button class="filter-btn active" onclick="setTimeFilter('7d')">Last 7 Days</button>
        <button class="filter-btn" onclick="setTimeFilter('30d')">Last 30 Days</button>
        <button class="filter-btn" onclick="setTimeFilter('90d')">Last 90 Days</button>
        <button class="filter-btn" onclick="setTimeFilter('all')">All Time</button>
      </div>

      {% if stats %}
        <!-- Key Metrics -->
        <div class="grid grid-4 mb-5">
          <div class="metric-card">
            <div class="metric-header">
              <div class="metric-icon">
                <i class="fas fa-ticket-alt"></i>
              </div>
              <div>
                <div class="metric-title">Total Tickets</div>
                <div class="metric-subtitle">All events</div>
              </div>
            </div>
            <div class="metric-value">{{ stats.total_tickets or 0 }}</div>
            <div class="metric-change positive">
              <i class="fas fa-arrow-up"></i> +12% from last week
            </div>
          </div>
          
          <div class="metric-card">
            <div class="metric-header">
              <div class="metric-icon">
                <i class="fas fa-users"></i>
              </div>
              <div>
                <div class="metric-title">Total Guests</div>
                <div class="metric-subtitle">All events</div>
              </div>
            </div>
            <div class="metric-value">{{ stats.total_people or 0 }}</div>
            <div class="metric-change positive">
              <i class="fas fa-arrow-up"></i> +8% from last week
            </div>
          </div>
          
          <div class="metric-card">
            <div class="metric-header">
              <div class="metric-icon">
                <i class="fas fa-check-circle"></i>
              </div>
              <div>
                <div class="metric-title">Check-in Rate</div>
                <div class="metric-subtitle">Success rate</div>
              </div>
            </div>
            <div class="metric-value">{{ "%.1f"|format(stats.checkin_rate or 0) }}%</div>
            <div class="metric-change positive">
              <i class="fas fa-arrow-up"></i> +5% from last week
            </div>
          </div>
          
          <div class="metric-card">
            <div class="metric-header">
              <div class="metric-icon">
                <i class="fas fa-calendar"></i>
              </div>
              <div>
                <div class="metric-title">Active Events</div>
                <div class="metric-subtitle">This month</div>
              </div>
            </div>
            <div class="metric-value">{{ stats.active_events or 0 }}</div>
            <div class="metric-change positive">
              <i class="fas fa-arrow-up"></i> +2 new events
            </div>
          </div>
        </div>

        <!-- Charts -->
        <div class="grid grid-2">
          <div class="chart-container">
            <h3 class="chart-title">Ticket Sales Over Time</h3>
            <div class="chart-placeholder">
              <i class="fas fa-chart-line"></i> Chart coming soon...
            </div>
          </div>
          
          <div class="chart-container">
            <h3 class="chart-title">Check-in Activity</h3>
            <div class="chart-placeholder">
              <i class="fas fa-chart-bar"></i> Chart coming soon...
            </div>
          </div>
        </div>

        <div class="grid grid-2">
          <div class="chart-container">
            <h3 class="chart-title">Event Performance</h3>
            <div class="chart-placeholder">
              <i class="fas fa-chart-pie"></i> Chart coming soon...
            </div>
          </div>
          
          <div class="chart-container">
            <h3 class="chart-title">Guest Demographics</h3>
            <div class="chart-placeholder">
              <i class="fas fa-chart-area"></i> Chart coming soon...
            </div>
          </div>
        </div>
      {% else %}
        <div class="empty-state">
          <i class="fas fa-chart-bar"></i>
          <h3>No Analytics Data</h3>
          <p>Start creating events and tickets to see analytics here.</p>
          <a href="/events" class="btn-modern">
            <i class="fas fa-plus"></i> Create Your First Event
          </a>
        </div>
      {% endif %}
    </main>
  </div>

  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
  <script>
    function setTimeFilter(period) {
      // Remove active class from all buttons
      document.querySelectorAll('.filter-btn').forEach(btn => {
        btn.classList.remove('active');
      });
      
      // Add active class to clicked button
      event.target.classList.add('active');
      
      // Here you would typically reload data based on the selected period
      console.log('Filter changed to:', period);
    }

    // Add active class to current page
    document.addEventListener('DOMContentLoaded', function() {
      const currentPath = window.location.pathname;
      const navItems = document.querySelectorAll('.nav-item');
      
      navItems.forEach(item => {
        if (item.getAttribute('href') === currentPath) {
          item.classList.add('active');
        }
      });
    });
  </script>
</body>
</html> 